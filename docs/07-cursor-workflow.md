# Cursor Workflow

Этот документ описывает типовой workflow совместной отладки
и анализа симуляций с использованием teltel и Cursor AI.

Цель — превратить телеметрию в осмысленный инженерный процесс.

---

## Роль Cursor

Cursor рассматривается как:
- инженерный ассистент
- аналитик телеметрии
- инструмент для поиска аномалий и гипотез

Cursor **не является**:
- источником истины
- заменой понимания системы
- автоматическим дебаггером

---

## Базовый сценарий

### 1. Обнаружение проблемы

Разработчик наблюдает странное поведение:
- нестабильность
- рывки
- неожиданные силы
- рассинхрон состояний

Проблема обнаруживается визуально или по ощущению.

---

### 2. Включение логирования

Логирование включается **явно** в одном из модулей:
- Flight Engine
- Drive Engine

При включении:
- создаётся новый `run`
- генерируется `runId`
- события начинают поступать в teltel

Логирование не является фоновым процессом.

---

### 3. Воспроизведение проблемы

Разработчик:
- воспроизводит сценарий
- доводит систему до проблемного состояния
- наблюдает проявление симптома

После этого логирование выключается,
run считается завершённым.

---

### 4. Формирование запроса для Cursor

Разработчик формулирует **инженерный запрос**.

Пример:

```
В Drive Engine наблюдается резкий рывок при выходе из поворота
на малой скорости.

Я включил логирование и воспроизвёл проблему.

Run ID: <runId>

Посмотри телеметрию этого run:
- wheel.force
- slipRatio
- drivetrain state
- dt

Попробуй найти аномалию или рассинхрон.
```

Важно:
- указывается конкретный run
- описывается симптом
- задаётся направление анализа

---

### 5. Действия Cursor

Cursor:
1. Извлекает данные run’а из ClickHouse
2. Строит временные ряды по frameIndex
3. Синхронизирует series
4. Ищет:
   - скачки
   - выбросы
   - NaN
   - резкие изменения знака
   - несоответствия ожиданиям

---

### 6. Результат анализа

Cursor возвращает:
- наблюдения
- возможные причины
- гипотезы
- указание на конкретные кадры

Пример:

> На frame ~1840 наблюдается резкий скачок slipRatio
> заднего правого колеса.
> В этот же кадр dt увеличивается в 2 раза,
> а torque меняет знак.
> Возможна проблема в переходе между режимами сцепления.

---

## Принципы эффективной работы

### Явный контекст

Cursor работает лучше, когда:
- указан runId
- описан симптом
- заданы интересующие подсистемы

---

### Ограниченный объём данных

Логирование:
- включается вручную
- охватывает только нужный участок
- не является постоянным

---

### Cursor как ассистент, а не оракул

Cursor:
- помогает анализировать
- предлагает гипотезы
- не принимает решений

---

## Типовые запросы Cursor

- “Сравни этот run с предыдущим”
- “Найди кадры с аномальным dt”
- “Проверь корреляцию между X и Y”
- “Построй series для …”

---

## Ограничения Cursor

Cursor:
- работает только с сохранёнными данными
- не видит live‑поток
- не управляет симуляцией
- не изменяет код автоматически

---

## Связанные документы

- `docs/03-event-model.md`
- `docs/05-ingest-and-storage.md`
- `docs/06-live-ui.md`
- `docs/09-roadmap.md`
