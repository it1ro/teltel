# Roadmap

Этот документ описывает поэтапный план разработки teltel.

Цель roadmap — обеспечить:
- предсказуемое развитие системы
- минимальный объём работы на каждом этапе
- возможность раннего использования
- удобство планирования для Cursor

---

## Phase 0 — Foundation (Architecture & Contracts)

**Статус:** завершено

Цели:
- зафиксировать архитектуру
- определить контракты
- исключить архитектурные развилки

Результаты:
- документация в `docs/`
- Event model
- EventBus API
- ingest и storage pipeline
- failure modes
- Cursor workflow

---

## Phase 1 — Core Service (MVP)

**Статус:** завершено

Цель:
> Получить работающий локальный сервис,
> принимающий телеметрию и показывающий live‑графики.

### Задачи

#### 1. HTTP Ingest
- NDJSON streaming endpoint
- минимальная валидация
- интеграция с EventBus

#### 2. EventBus (in‑process)
- Publish / Subscribe
- фильтрация
- backpressure
- метрики

#### 3. Live Buffer
- ring buffer per run
- tail + live
- ограничение памяти

#### 4. WebSocket API
- подписки
- фильтры
- live‑поток

#### 5. Minimal Live UI
- список run’ов
- live‑графики
- базовые series

---

## Phase 2 — Storage & Analysis

Цель:
> Сделать run’ы анализируемыми после завершения.

### Задачи

#### 1. ClickHouse schema
- таблица событий
- оптимизация ORDER BY

#### 2. Batcher
- подписка на EventBus
- batch‑вставки
- flush‑логика

#### 3. Run lifecycle
- явное завершение run
- метаданные run’а

#### 4. SQL helpers
- примеры запросов
- извлечение series
- сравнение run’ов

---

## Phase 3 — UX & Cursor Integration

Цель:
> Сделать анализ быстрым и удобным.

### Задачи

#### 1. UI improvements
- presets графиков
- навигация по frameIndex
- сравнение run’ов

#### 2. Cursor helpers
- примеры запросов
- шаблоны анализа
- документация для reasoning

#### 3. Export tools
- выгрузка run’ов
- CSV / JSON для внешнего анализа

---

## Phase 4 — Extensions (Optional)

Цель:
> Расширение возможностей без изменения ядра.

Возможные направления:
- альтернативные EventBus адаптеры
- offline replay
- anomaly markers
- CI‑интеграция
- автоматическое сравнение run’ов

Все расширения:
- не ломают Phase 1–3
- не усложняют hot‑path
- соответствуют goals/non‑goals

---

## Engineering Validation

**Статус:** планируется

Цель:
> Проверить поведение системы под нагрузкой,
> деградацию и отказы в контролируемых условиях.

### Назначение

Engineering Validation — это **не функциональная фаза**.
Она не добавляет новый функциональный код,
а проверяет соответствие реализованной системы
архитектурным принципам и ожидаемому поведению.

### Задачи

#### 1. Сценарии нагрузки

- высокая частота событий (10k+ событий/сек)
- множественные одновременные run'ы
- длительные сессии (часы работы)
- пиковые нагрузки (burst events)

#### 2. Сценарии деградации

- перегрузка ingest
- медленные подписчики EventBus
- переполнение Live Buffer
- перегрузка WebSocket соединений

#### 3. Сценарии отказов

- некорректные события
- внезапное отключение клиентов
- перезапуск сервиса
- сетевые проблемы

#### 4. Валидация поведения

- проверка best-effort доставки
- изоляция компонентов
- отсутствие каскадных отказов
- корректная работа backpressure

### Результаты

- документация сценариев тестирования
- зафиксированное ожидаемое поведение
- метрики производительности
- рекомендации по настройке

### Ограничения

- не добавляется новый функциональный код
- не меняются архитектурные контракты
- не рефакторится код без необходимости
- тестирование выполняется на существующем коде Phase 1–3

---

## Принцип развития

- сначала простота
- затем удобство
- затем расширения

Любая задача должна отвечать на вопрос:
> “Помогает ли это анализу симуляций
> без увеличения влияния на движки?”

---

## Классификация фаз

### Функциональные фазы

Phase 1–4 являются **функциональными фазами**:
- добавляют новый функциональный код
- расширяют возможности системы
- не содержат инженерного тестирования

### Валидационная фаза

Engineering Validation является **валидационной фазой**:
- не добавляет функциональный код
- проверяет соответствие реализации принципам
- фиксирует поведение системы под нагрузкой

---

## Использование Cursor

Cursor рекомендуется использовать для:
- планирования функциональных фаз
- декомпозиции задач
- анализа телеметрии
- поиска аномалий

Cursor **не используется** для:
- изменения архитектурных контрактов
- принятия продуктовых решений
